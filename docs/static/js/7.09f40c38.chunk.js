(this["webpackJsonpvideo-loop-tool"]=this["webpackJsonpvideo-loop-tool"]||[]).push([[7],{130:function(e,t,i){},165:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return k}));var a=i(125),l=i.n(a),r=i(127),s=i(103),n=i(104),o=i(110),d=i(109),u=i(128),h=i.n(u),c=i(0),y=i(176),p=i(10),m=i(97),v=i(99),g=i(96),T=i(174),f=i(178),V=i(183),x=i(179),b=i(177),j=i(98),w=i(175),S=i(129),P=i.n(S),O=(i(130),i(3)),I=Object(p.a)(y.a)((function(e){e.theme;return{"& .MuiSlider-thumb":{height:36,width:36},"& .MuiSlider-rail":{height:12},"& .MuiSlider-track":{height:14}}})),k=function(e){Object(o.a)(i,e);var t=Object(d.a)(i);function i(e){var a;Object(s.a)(this,i),(a=t.call(this,e)).state=void 0,a.changingVideo=void 0,a.player=void 0,a.startTimeHandle=void 0,a.endTimeHandle=void 0,a.startTimeValue=void 0,a.endTimeValue=void 0,a.sliderMaxValue=void 0,a.loopTimeout=void 0,a.delayTimer=void 0,a.urlParameters=void 0,a.queryStartTime=void 0,a.queryEndTime=void 0,a.playlists=void 0,a.startTimeValue=0,a.endTimeValue=0,a.sliderMaxValue=0,a.urlParameters=new URLSearchParams(window.location.search);var l=localStorage.getItem("Playlists");a.playlists=null!==l?JSON.parse(l):[];return a.state={videoId:a.urlParameters.get("v"),videoDelay:null!==a.urlParameters.get("d")?parseInt(a.urlParameters.get("d")):0,currentVideoDelay:0,selectedPlaylist:undefined,selectedVideoId:undefined,sliderValues:[0,0],playThroughPlaylist:!1},a.changingVideo=!1,a.queryStartTime=a.urlParameters.get("s"),a.queryEndTime=a.urlParameters.get("e"),Object(u.isNumeric)(a.queryStartTime)||(a.queryStartTime="0"),Object(u.isNumeric)(a.queryEndTime)||(a.queryEndTime="0"),a}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.state.videoId&&setTimeout((function(){if(void 0!==e.state.selectedPlaylist&&void 0!==e.state.selectedVideoId){var t=e.playlists[e.state.selectedPlaylist].Videos.filter((function(t){return t.Id===e.state.selectedVideoId}))[0];void 0!==t?e.selectVideo(t):e.startVideo()}else e.startVideo()}),1e3)}},{key:"startDelayTimer",value:function(e){var t=this;this.urlParameters.set("d",this.state.videoDelay.toString()),this.urlParameters.set("v",this.state.videoId);var i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.urlParameters.toString();window.history.pushState({path:i},"",i),this.delayTimer&&clearInterval(this.delayTimer),0!=this.state.videoDelay?(this.state.currentVideoDelay=this.state.videoDelay,this.delayTimer=setInterval((function(){var i=t.state.currentVideoDelay-.1;if(i<0)return t.setState({currentVideoDelay:0}),clearInterval(t.delayTimer),void e();t.setState({currentVideoDelay:i})}),100)):e()}},{key:"loopYouTubeVideo",value:function(){var e=this;if(this.player)return this.loopTimeout&&clearTimeout(this.loopTimeout),this.player.loadVideoById(this.state.videoId),void this.setupVideoPlayer();var t=window;t.YT?this.loadPlayer(this.state.videoId):(t.onYouTubePlayerAPIReady=function(){e.loadPlayer(e.state.videoId)},h.a.getScript("https://www.youtube.com/player_api"))}},{key:"loadPlayer",value:function(e){var t=this;this.player=new window.YT.Player("player",{playerVars:{modestbranding:1,rel:0,showinfo:0,loop:1,autoplay:1,mute:1},height:360,width:"100%",videoId:e,events:{onReady:function(e){return t.playerOnReady(e)},onStateChange:function(e){return t.playerOnStateChange(e)}}})}},{key:"setupVideoPlayer",value:function(){var e=this;this.player.mute(),setTimeout(Object(r.a)(l.a.mark((function t(){var i,a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDuration();case 2:i=t.sent,a=parseInt(e.queryStartTime)||0,r=parseInt(e.queryEndTime)||i,e.sliderMaxValue=i,e.createSlider(a,r),e.player.unMute(),setTimeout((function(){e.player.seekTo(e.startTimeValue,!0)}));case 9:case"end":return t.stop()}}),t)}))))}},{key:"playerOnReady",value:function(e){this.setupVideoPlayer()}},{key:"playerOnStateChange",value:function(e){var t=this;e.data===window.YT.PlayerState.PLAYING?(this.player&&this.player.getCurrentTime()<this.startTimeValue&&this.player.seekTo(this.startTimeValue,!0),this.loopTimeout=setInterval((function(){if(t.player.getCurrentTime&&(!(t.player.getCurrentTime()<t.endTimeValue)&&!t.changingVideo))if(void 0!==t.state.selectedPlaylist&&t.state.playThroughPlaylist){t.changingVideo=!0;for(var e=t.playlists[t.state.selectedPlaylist].Videos,i=void 0,a=0;a<e.length;a++)if(e[a].Id===t.state.selectedVideoId){i=a===e.length-1?e[0]:e[a+1];break}void 0!==i?t.selectVideo(i):t.player.seekTo(t.startTimeValue,!0),setTimeout((function(){t.changingVideo=!1}),1e3)}else t.state.videoDelay>0?(t.player.pauseVideo(),t.player.seekTo(t.startTimeValue,!0),t.startDelayTimer((function(){t.player.playVideo()}))):t.player.seekTo(t.startTimeValue,!0)}),1e3)):e.data===window.YT.PlayerState.PAUSED?this.loopTimeout&&clearTimeout(this.loopTimeout):e.data===window.YT.PlayerState.ENDED&&(this.loopTimeout&&clearTimeout(this.loopTimeout),this.player.seekTo(this.startTimeValue,!0))}},{key:"getDuration",value:function(){var e=Object(r.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.player){e.next=4;break}return e.next=3,0;case 3:return e.abrupt("return",e.sent);case 4:t=this.player.getDuration();case 5:if(t&&0!==t){e.next=11;break}return t=this.player.getDuration(),e.next=9,this.delay(500);case 9:e.next=5;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delay",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"createSlider",value:function(e,t){var i=h()(".videoSlider")[0],a=h()(i.children[i.children.length-2]),l=h()(i.children[i.children.length-1]);a.children("#videoSliderTime").length>0&&a.children("#videoSliderTime").remove(),l.children("#videoSliderTime").length>0&&l.children("#videoSliderTime").remove(),e=e<0?0:e,this.startTimeHandle=a.prepend(this.wrap(e,!0,!0)),this.endTimeHandle=l.prepend(this.wrap(t,!0,!1)),this.startTimeValue=e,this.endTimeValue=t,this.urlParameters.set("s",this.startTimeValue.toString()),this.urlParameters.set("e",this.endTimeValue.toString());var r=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.urlParameters.toString();window.history.pushState({path:r},"",r),this.setState({sliderValues:[this.startTimeValue,this.endTimeValue]})}},{key:"sliderMoved",value:function(e,t){this.startTimeValue=e,this.endTimeValue=t,this.startTimeHandle&&(this.startTimeHandle[0].children[0].textContent=new Date(1e3*this.startTimeValue).toISOString().substr(11,8),this.urlParameters.set("s",this.startTimeValue.toString())),this.endTimeHandle&&(this.endTimeHandle[0].children[0].textContent=new Date(1e3*this.endTimeValue).toISOString().substr(11,8),this.urlParameters.set("e",this.endTimeValue.toString()));var i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.urlParameters.toString();window.history.pushState({path:i},"",i),(this.player.getCurrentTime()<this.startTimeValue||this.player.getCurrentTime()>this.endTimeValue)&&this.player.seekTo(this.startTimeValue,!0)}},{key:"wrap",value:function(e,t,i){var a=e.toString();t&&(a=new Date(1e3*e).toISOString().substr(11,8));var l=i?"-13px":"57px";return P.a.sanitize('<span id="videoSliderTime" style="color: #000 !important; font-family: Roboto, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 400; position: absolute !important; bottom: -50px; left: '+l+';">'+a+"</span>")}},{key:"selectVideo",value:function(e){var t=this;this.queryStartTime=e.StartTime.toString(),this.queryEndTime=e.EndTime.toString();var i=document.getElementById("video-"+e.Id);null===i||void 0===i||i.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),this.setState({videoId:e.VideoId,selectedVideoId:e.Id,videoDelay:e.Delay,currentVideoDelay:0},(function(){t.startVideo()}))}},{key:"startVideo",value:function(){var e=this;this.sliderMaxValue>0&&this.player.pauseVideo(),this.startDelayTimer((function(){e.loopYouTubeVideo()}))}},{key:"handleVideoDelayChange",value:function(e){this.setState({videoDelay:Object(u.isNumeric)(e.target.value)?parseInt(e.target.value):0})}},{key:"handleVideoIdChange",value:function(e){this.setState({videoId:e.target.value})}},{key:"handlePlaylistDropdownChange",value:function(e){var t=Object(u.isNumeric)(e.target.value)?parseInt(e.target.value):void 0;this.setState({selectedPlaylist:t,selectedVideoId:void 0})}},{key:"handlePlayThroughPlaylistChange",value:function(e,t){this.setState({playThroughPlaylist:t})}},{key:"handleSliderChange",value:function(e,t){var i=t;this.sliderMoved(i[0],i[1]),this.setState({sliderValues:i})}},{key:"render",value:function(){var e=this,t=[];return void 0!==this.state.selectedPlaylist&&(t=this.playlists[this.state.selectedPlaylist].Videos.map((function(t,i){return Object(O.jsx)(m.a,{variant:"outlined",style:{margin:"12px",padding:"0 !important",background:t.Id===e.state.selectedVideoId?"#ccc":"#fff"},id:"video-"+t.Id,children:Object(O.jsx)(v.a,{style:{paddingBottom:"0 !important"},children:Object(O.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[t.Id===e.state.selectedVideoId&&Object(O.jsx)("h6",{style:{flex:"0 0 100%"},children:"Currently playing"}),Object(O.jsx)("img",{alt:t.Name,src:"https://img.youtube.com/vi/"+t.VideoId+"/hqdefault.jpg",style:{width:"80x",height:"45px",marginRight:"12px",paddingBottom:"12px"}}),Object(O.jsx)("div",{style:{alignSelf:"center"},children:Object(O.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(i){e.selectVideo(t)},style:{marginRight:"12px"},children:"Select"})},t.Id),Object(O.jsxs)("p",{children:[Object(O.jsxs)("strong",{children:[t.Name," (",t.StartTime,"s - ",t.EndTime,"s)"]}),"(",t.Delay,"s delay)"]})]},t.Id)},t.Id)},t.Id)}))),Object(O.jsx)(m.a,{variant:"outlined",style:{margin:"12px",padding:"0 !important",minHeight:"950px"},children:Object(O.jsx)(v.a,{style:{padding:"0 !important"},children:Object(O.jsxs)("div",{style:{textAlign:"left",margin:"0 auto",display:"flex"},className:"outerContainer",children:[Object(O.jsx)("div",{className:"playlistsContainer",children:Object(O.jsx)("div",{style:{display:"block",textAlign:"left"},children:Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:"Playlists"}),Object(O.jsx)(T.a,{label:"Playlists",displayEmpty:!0,renderValue:void 0!==this.state.selectedPlaylist?function(){return e.playlists[e.state.selectedPlaylist].Name}:function(){return"Playlists"},defaultValue:"Playlists",onChange:function(t){return e.handlePlaylistDropdownChange(t)},style:{minWidth:"200px"},children:[Object(O.jsx)(f.a,{value:void 0,children:"None"},"none"),this.playlists.map((function(e,t){return Object(O.jsxs)(f.a,{value:t,children:["#",e.Id,": ",e.Name]},e.Id)}))]}),Object(O.jsx)(V.a,{style:{display:void 0!==this.state.selectedPlaylist?"block":"none"},children:Object(O.jsx)(x.a,{control:Object(O.jsx)(b.a,{defaultChecked:this.state.playThroughPlaylist,onChange:function(t,i){return e.handlePlayThroughPlaylistChange(t,i)}}),label:"Play through Playlist"})}),Object(O.jsx)(j.a,{style:{maxHeight:"500px",overflow:"auto",marginTop:"12px"},children:t.map((function(e){return e}))})]})})}),Object(O.jsxs)("div",{style:{width:"100%",marginLeft:"42px",marginRight:"96px"},children:[Object(O.jsx)("h1",{children:"Video Loop Tool"}),Object(O.jsxs)("div",{style:{display:"flex",marginBottom:"12px"},children:[Object(O.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(){e.startVideo()},style:{marginTop:"12px",marginRight:"12px"},children:"Start"}),Object(O.jsx)(w.a,{id:"standard-basic",label:"YouTube VideoID",value:this.state&&this.state.videoId||"",style:{width:"200px"},onChange:function(t){return e.handleVideoIdChange(t)}}),Object(O.jsx)(w.a,{id:"standard-basic",label:"Video Delay",value:this.state&&this.state.videoDelay||0,style:{width:"200px"},onChange:function(t){return e.handleVideoDelayChange(t)}})]}),Object(O.jsx)("div",{style:{display:this.state.currentVideoDelay>0?"block":"none",width:"640px",height:"480px",backgroundColor:"#333",lineHeight:"480px"},children:Object(O.jsxs)("h1",{style:{margin:"0px",textAlign:"center",color:"#fff"},children:[this.state.currentVideoDelay.toFixed(1),"s"]})}),Object(O.jsxs)("div",{className:"auto-resizable-iframe",style:{display:this.player?"block":"none"},children:[Object(O.jsx)("div",{className:"playerWrapper",style:{display:0==this.state.currentVideoDelay?"block":"none"},children:Object(O.jsx)("div",{id:"player"})}),Object(O.jsx)("div",{style:{display:"flex",marginTop:"36px",maxWidth:"100%"},children:Object(O.jsx)(I,{value:this.state.sliderValues,valueLabelFormat:function(e){return e+"s"},onChange:function(t,i){return e.handleSliderChange(t,i)},valueLabelDisplay:"auto",min:0,max:this.sliderMaxValue,className:"videoSlider"})})]})]})]})})})}}]),i}(c.Component)}}]);
//# sourceMappingURL=7.09f40c38.chunk.js.map